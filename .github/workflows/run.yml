name: All-in-One Investment Bot

on:
  schedule:
    # 1ï¸âƒ£ ê³µì‹œ ìŠ¤ë‚˜ì´í¼ (ì¥ì¤‘ ì‹¤ì‹œê°„ ê°ì‹œ)
    # í•œêµ­ 09:00 ~ 18:00 (UTC 00:00 ~ 09:00), 20ë¶„ ê°„ê²©
    - cron: '*/20 0-9 * * 1-5'

    # 2ï¸âƒ£ ì£¼ì‹/ì‹œí™© í†µí•© ë¦¬í¬íŠ¸ (ì´ë©”ì¼ ë°œì†¡)
    # í•œêµ­ 17:00 (UTC 08:00)
    - cron: '0 8 * * 1-5'

    # 3ï¸âƒ£ í…”ë ˆê·¸ë¨ ì±„ë„ ì¸ì‚¬ì´íŠ¸ (í…”ë ˆê·¸ë¨ ë°œì†¡)
    # í•œêµ­ 20:00 (UTC 11:00) - í•˜ë£¨ ë§ˆë¬´ë¦¬ìš©
    - cron: '0 11 * * 1-5'

  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

jobs:
  run-bots:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      # ğŸ“š [ì—ëŸ¬ í•´ê²° í•µì‹¬] python-telegram-bot ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ë¨!
      - name: Install Libraries
        run: pip install pdfplumber requests beautifulsoup4 google-generativeai python-telegram-bot

      # ---------------------------------------------------------------
      # ğŸ¤– 1. ê³µì‹œ ìŠ¤ë‚˜ì´í¼ (dart_bot.py)
      # ì¡°ê±´: ìŠ¤ì¼€ì¤„ì´ 20ë¶„ ê°„ê²©ì´ê±°ë‚˜(ë‚®ì‹œê°„), ìˆ˜ë™ ì‹¤í–‰ì¼ ë•Œ
      # ---------------------------------------------------------------
      - name: Run Disclosure Sniper
        if: contains(github.event.schedule, '*/20') || github.event_name == 'workflow_dispatch'
        env:
          API_KEY: ${{ secrets.API_KEY }}
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python dart_bot.py

      # ---------------------------------------------------------------
      # ğŸ¤– 2. ì£¼ì‹/ì‹œí™© í†µí•© ë¦¬í¬íŠ¸ (main.py)
      # ì¡°ê±´: ìŠ¤ì¼€ì¤„ì´ 08:00(ì˜¤í›„5ì‹œ) ì´ê±°ë‚˜, ìˆ˜ë™ ì‹¤í–‰ì¼ ë•Œ
      # ---------------------------------------------------------------
      - name: Run Main Stock Report
        if: github.event.schedule == '0 8 * * 1-5' || github.event_name == 'workflow_dispatch'
        env:
          API_KEY: ${{ secrets.API_KEY }}
          MY_EMAIL: ${{ secrets.MY_EMAIL }}
          APP_PASSWORD: ${{ secrets.APP_PASSWORD }}
          TO_EMAIL: ${{ secrets.TO_EMAIL }}
        run: python main.py

      # ---------------------------------------------------------------
      # ğŸ¤– 3. í…”ë ˆê·¸ë¨ ì¸ì‚¬ì´íŠ¸ (telegram_bot.py)
      # ì¡°ê±´: ìŠ¤ì¼€ì¤„ì´ 11:00(ì €ë…8ì‹œ) ì´ê±°ë‚˜, ìˆ˜ë™ ì‹¤í–‰ì¼ ë•Œ
      # ---------------------------------------------------------------
      - name: Run Telegram Insight
        if: github.event.schedule == '0 11 * * 1-5' || github.event_name == 'workflow_dispatch'
        env:
          API_KEY: ${{ secrets.API_KEY }}
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: python telegram_bot.py
